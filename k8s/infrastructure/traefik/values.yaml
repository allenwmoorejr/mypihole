# k8s/infrastructure/traefik/values.yaml

# Expose Traefik via MetalLB on 192.168.50.242
service:
  enabled: true
  type: LoadBalancer
  spec:
    loadBalancerIP: 192.168.50.242
    externalTrafficPolicy: Cluster

ports:
  web:
    # HTTP entrypoint
    port: 80
    expose:
      default: true
    exposedPort: 80
    protocol: TCP

  websecure:
    # HTTPS entrypoint
    port: 443
    expose:
      default: true
    exposedPort: 443
    protocol: TCP
    tls:
      enabled: true

# Make Traefik a proper IngressClass
ingressClass:
  enabled: true
  isDefaultClass: true
  name: traefik

providers:
  kubernetesCRD:
    enabled: true
  kubernetesIngress:
    enabled: true
    publishedService:
      enabled: true

# Simple HTTP -> HTTPS redirect on the web entrypoint
additionalArguments:
  - "--entrypoints.web.http.redirections.entrypoint.to=websecure"
  - "--entrypoints.web.http.redirections.entrypoint.scheme=https"

# Leave dashboard on defaults (disabled / internal only).
# If you ever enable:
# ingressRoute:
#   dashboard:
#     enabled: true
#     tls: {}  # must be an object, not 'true'

