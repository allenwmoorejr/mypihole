# k8s/infrastructure/traefik/values.yaml

deployment:
  replicas: 2

ports:
  web:
    port: 80
    expose: true
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 443
    expose: true
    exposedPort: 443
    protocol: TCP

service:
  enabled: true
  type: LoadBalancer
  # This should be an IP from your MetalLB pool, e.g. 192.168.50.242
  spec:
    loadBalancerIP: 192.168.50.242
    externalTrafficPolicy: Local

ingressClass:
  enabled: true
  isDefaultClass: true
  name: traefik

providers:
  kubernetesCRD:
    enabled: true
  kubernetesIngress:
    enabled: true
    # Let Traefik advertise the correct ingress IP/ports
    publishedService:
      enabled: true

logs:
  general:
    level: INFO
  access:
    enabled: true

# Redirect HTTP -> HTTPS
additionalArguments:
  - "--entrypoints.web.http.redirections.entryPoint.to=websecure"
  - "--entrypoints.web.http.redirections.entryPoint.scheme=https"

# Optional: dashboard via traefik.suite.home.arpa over HTTPS
ingressRoute:
  dashboard:
    enabled: true
    entryPoints:
      - websecure
    matchRule: Host(`traefik.suite.home.arpa`)
    tls: true

